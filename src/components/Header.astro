---
import HeaderLink from './HeaderLink.astro';
import { SITE_TITLE } from '../consts';

const { pathname } = Astro.url;
const subpath = pathname.match(/[^\/]+/g);
---

<header>
	<div class="progressive-blur-wrapper">
		<div class="progressive-blur"></div>
		<div class="progressive-blur"></div>
		<div class="progressive-blur"></div>
		<div class="progressive-blur"></div>
		<div class="progressive-blur"></div>
		<div class="progressive-blur"></div>
	</div>
	<nav>
		<HeaderLink href="/">{SITE_TITLE}{subpath && `/${subpath}`}</HeaderLink>
		<div class="internal-links">
			<HeaderLink href="/blog">Blog</HeaderLink>
			<HeaderLink href="/projects">Projects</HeaderLink>
			<HeaderLink href="/about">About</HeaderLink>
		</div>
	</nav>
</header>
<style lang="scss">
	header {
		width: 100%;
		position: fixed;
		top: 0;
		left: 0;
		margin: 0;

		.progressive-blur-wrapper {
			position: fixed;
			z-index: 5;
			inset: 0 0 auto 0;
			height: calc(var(--space-3xl));
			pointer-events: none;

			div {
				position: absolute;
				inset: 0;
			}

			&:before {
				position: absolute;
				inset: 0;
				content: "";
				z-index: 1;
				backdrop-filter: blur(0.5px);
				mask: linear-gradient(
						to top,
						rgba(0, 0, 0, 0) 0%,
						rgba(0, 0, 0, 1) 12.5%,
						rgba(0, 0, 0, 1) 25%,
						rgba(0, 0, 0, 0) 37.5%
				);
			}

			& > div:nth-of-type(1) {
				z-index: 2;
				backdrop-filter: blur(1px);
				mask: linear-gradient(
						to top,
						rgba(0, 0, 0, 0) 12.5%,
						rgba(0, 0, 0, 1) 25%,
						rgba(0, 0, 0, 1) 37.5%,
						rgba(0, 0, 0, 0) 50%
				);
			}

			& > div:nth-of-type(2) {
				z-index: 3;
				backdrop-filter: blur(2px);
				mask: linear-gradient(
						to top,
						rgba(0, 0, 0, 0) 25%,
						rgba(0, 0, 0, 1) 37.5%,
						rgba(0, 0, 0, 1) 50%,
						rgba(0, 0, 0, 0) 62.5%
				);
			}
			& > div:nth-of-type(3) {
				z-index: 4;
				backdrop-filter: blur(4px);
				mask: linear-gradient(
						to top,
						rgba(0, 0, 0, 0) 37.5%,
						rgba(0, 0, 0, 1) 50%,
						rgba(0, 0, 0, 1) 62.5%,
						rgba(0, 0, 0, 0) 75%
				);
			}
			& > div:nth-of-type(4) {
				z-index: 5;
				backdrop-filter: blur(8px);
				mask: linear-gradient(
						to top,
						rgba(0, 0, 0, 0) 50%,
						rgba(0, 0, 0, 1) 62.5%,
						rgba(0, 0, 0, 1) 75%,
						rgba(0, 0, 0, 0) 87.5%
				);
			}
			& > div:nth-of-type(5) {
				z-index: 6;
				backdrop-filter: blur(16px);
				mask: linear-gradient(
						to top,
						rgba(0, 0, 0, 0) 62.5%,
						rgba(0, 0, 0, 1) 75%,
						rgba(0, 0, 0, 1) 87.5%,
						rgba(0, 0, 0, 0) 100%
				);
			}
			& > div:nth-of-type(6) {
				z-index: 7;
				backdrop-filter: blur(32px);
				mask: linear-gradient(
						to top,
						rgba(0, 0, 0, 0) 75%,
						rgba(0, 0, 0, 1) 87.5%,
						rgba(0, 0, 0, 1) 100%
				);
			}
			&:after {
				position: absolute;
				inset: 0;
				content: "";
				z-index: 8;
				backdrop-filter: blur(64px);
				mask: linear-gradient(
						to top,
						rgba(0, 0, 0, 0) 87.5%,
						rgba(0, 0, 0, 1) 100%
				);
			}
		}

		nav {
			display: flex;
			align-items: center;
			justify-content: space-between;
			position: relative;
			z-index: 100;

			a {
				padding: var(--space-xs) var(--space-s);
				color: var(--color-secondary);
				border-bottom: 4px solid transparent;
				text-decoration: none;

				&.home {
					color: var(--color-primary);
				}

				&.active {
					text-decoration: none;
					color: var(--color-highlight);
				}
			}
		}
	}
</style>
